### Personal ggplot theme: 
library(ggplot2)
p <- ggplot(iris, aes(x = Sepal.Length, y = Sepal.Width, col=Species)) + 
  geom_point()
p

devtools::source_url("https://github.com/juanchiem/R-sources/blob/master/theme_juan.R?raw=TRUE")
p + theme_juan(9, "bottom")

### Linear model assumptions

devtools::source_url("https://github.com/juanchiem/R-sources-Juan/blob/master/assumptions.R?raw=TRUE")

# mod <- lm(dist ~ speed, data = cars)
# assump(mod)

## Rendimiento ajustado por humedad 
## si la humedad de la muestra fue obtenida por gravimetria humedo-seco, rinde_aj2 devuelve la humedad calculada y 
## el el rendimiento (kg/h) ajustado a la humedad deseada

devtools::source_url("https://github.com/juanchiem/R-sources-Juan/blob/master/rend_aj.R?raw=TRUE")

dat <- tibble::tribble(
   ~par, ~trt, ~bq, ~peso_tot, ~peso_h, ~peso_s, 
  "1.1",    1,   1,      1297,   48.92,   47.85, 
  "2.1",    2,   1,      1358,   43.22,   42.62, 
  "3.1",    3,   1,      1176,    31.2,    30.8)

library(tidyverse)
dat %>% 
  rowwise() %>% 
  mutate(list(rinde_aj2(surcos = 4,
                        largo = 3,      # m
                        dist_surcos = 17.5, # cm
                        peso_h = peso_h,     # g
                        peso_s = peso_s,     # g
                        tara_s = 2,       # g
                        peso_tot = peso_tot,   # g
                        h_deseada = 13.5)))%>% # %
  unnest()
